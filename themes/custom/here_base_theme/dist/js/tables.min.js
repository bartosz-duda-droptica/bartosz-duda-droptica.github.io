"use strict";!function(e,s){function i(t,i){this.defaultSettings={classes:{tableWrapper:".tables__table",modifiers:{rowSticky:"tables__first-row-behaviour--sticky",columnSticky:"tables__first-column-behavior--sticky"},copyTableFlags:{main:"table-cloned",row:"table-cloned--row",column:"table-cloned--column",firstElement:"table-cloned--first-element",shadow:"table-cloned--shadow"}}},this.settings=e.extend(!0,this.defaultSettings,i||{}),this.$wrapper=t,this.$tableWrapper=jQuery,this.$copyOfRow=jQuery,this.$copyOfColumn=jQuery,this.$copyOfFirstElement=jQuery,this.$mainTable=jQuery,this.windowScrollTick=!1,this.tableScrollTick=!1,this.isRowSticky=!1,this.isColumnSticky=!1,this.initialised=!1,this.initialFirstColumnWidth=0,this.init()}i.prototype.init=function(){this.$tableWrapper=this.$wrapper.find(this.settings.classes.tableWrapper),this.$tableWrapper&&0!==this.$tableWrapper.length&&(this.isRowSticky=this.$tableWrapper.hasClass(this.settings.classes.modifiers.rowSticky),this.isColumnSticky=this.$tableWrapper.hasClass(this.settings.classes.modifiers.columnSticky),this.$mainTable=this.$tableWrapper.find("table:not(."+this.settings.classes.copyTableFlags.main+")").first(),(this.isRowSticky||this.isColumnSticky)&&this.$mainTable&&0!==this.$mainTable.length&&(this.initialFirstColumnWidth=this.$mainTable.find("th:first-child")[0].style.width,this.calculateWidthOfOriginalTableFirstColumn(),this.createNeededCopiesOfTable(),this.bindResizeEvent(),this.bindScrollEvent(),this.initialised=!0))},i.prototype.calculateWidthOfOriginalTableFirstColumn=function(){var t=s.utility.getDeviceName(),i="mobile"===t||"tabletS"===t?"130px":this.initialFirstColumnWidth;this.$mainTable.find("td:first-child, th:first-child").each(function(){e(this).css("width",i)})},i.prototype.createNeededCopiesOfTable=function(){!0===this.isRowSticky&&this.createCopyOfRow(),!0===this.isColumnSticky&&this.createCopyOfColumn(),!0===this.isRowSticky&&!0===this.isColumnSticky&&this.createCopyOfFirstElement()},i.prototype.bindResizeEvent=function(){var t=this;e(window).on("resize",function(){t.calculateWidthOfOriginalTableFirstColumn(),t.recalculateWidthAndHeight(),t.isRowSticky&&(t.calculateTransformOnTableScroll(),t.calculateTransformOnWindowScroll())})},i.prototype.windowScrollFrame=function(){this.isRowSticky&&this.calculateTransformOnWindowScroll(),this.windowScrollTick=!1},i.prototype.tableScrollFrame=function(){this.isRowSticky&&this.calculateTransformOnTableScroll(),this.isColumnSticky&&this.handleCopyColumnShadow(),this.tableScrollTick=!1},i.prototype.bindScrollEvent=function(){var t=this;this.$tableWrapper.on("scroll",function(){t.tableScrollTick||(window.requestAnimationFrame(t.tableScrollFrame.bind(t)),t.tableScrollTick=!0)}),e(window).on("scroll",function(){t.windowScrollTick||(window.requestAnimationFrame(t.windowScrollFrame.bind(t)),t.windowScrollTick=!0)})},i.prototype.createCopyOfRow=function(){var t=this.$mainTable.clone();t.find("tbody").remove(),t.addClass([this.settings.classes.copyTableFlags.main,this.settings.classes.copyTableFlags.row]),this.$mainTable.parent().append(t),this.$copyOfRow=this.$mainTable.parent().find("."+this.settings.classes.copyTableFlags.row),this.calculateWidthHeightOfRow()},i.prototype.calculateWidthHeightOfRow=function(){var s=this;this.$copyOfRow.find("th").each(function(t,i){e(this).css("width",s.$mainTable.find("th:eq("+t+")")[0].style.width)}),this.$copyOfRow.find("tr").each(function(){var t=s.$mainTable.find("tr").first();e(this).height(t.height())})},i.prototype.createCopyOfColumn=function(){var t=this.$mainTable.clone();t.find("td:not(:first-child), th:not(:first-child)").remove(),t.addClass([this.settings.classes.copyTableFlags.main,this.settings.classes.copyTableFlags.column]),this.$mainTable.parent().append(t),this.$copyOfColumn=this.$mainTable.parent().find("."+this.settings.classes.copyTableFlags.column),this.calculateWidthHeightOfColumn()},i.prototype.calculateWidthHeightOfColumn=function(){var s=this,t=this.$mainTable.find("th:first-child").first().outerWidth();this.$copyOfColumn.find("td:first-child, th:first-child").each(function(){e(this).css({width:t,"min-width":"unset"})}),this.$copyOfColumn.find("tr").each(function(t,i){e(this).height(s.$mainTable.find("tr:eq("+t+")").height())}),this.$copyOfColumn.css({width:t,"min-width":"unset"})},i.prototype.createCopyOfFirstElement=function(){var t=this.$mainTable.clone();t.find("tbody").remove(),t.find("th:not(:first-child)").remove(),t.addClass([this.settings.classes.copyTableFlags.main,this.settings.classes.copyTableFlags.firstElement]),this.$mainTable.parent().append(t),this.$copyOfFirstElement=this.$mainTable.parent().find("."+this.settings.classes.copyTableFlags.firstElement),this.calculateWidthHeightOfFirstElement()},i.prototype.calculateWidthHeightOfFirstElement=function(){var t=this.$mainTable.find("th:first-child").first().outerWidth(),i=this.$mainTable.find("th:first-child").first().css("height");this.$copyOfFirstElement.find("th:first-child").each(function(){e(this).css({width:t,height:i,"min-width":"unset"})}),this.$copyOfFirstElement.css({width:t,"min-width":"unset"})},i.prototype.recalculateWidthAndHeight=function(){!0===this.isRowSticky&&this.calculateWidthHeightOfRow(),!0===this.isColumnSticky&&this.calculateWidthHeightOfColumn(),!0===this.isRowSticky&&!0===this.isColumnSticky&&this.calculateWidthHeightOfFirstElement()},i.prototype.calculateTransformOnTableScroll=function(){var t=-this.$tableWrapper.scrollLeft()+"px",i=this.getTransformMatrixValue(this.$copyOfRow,5)+"px";this.$copyOfRow.css("transform","translate("+t+","+i+")")},i.prototype.calculateTransformOnWindowScroll=function(){var t=this.$mainTable.offset().top-e(window).scrollTop()<=this.getScrollTopTriggerValue()?this.calculateTranslateY()+"px":"0px",i=this.getTransformMatrixValue(this.$copyOfRow,4)+"px";this.$copyOfRow.css("transform","translate("+i+","+t+")"),this.isRowSticky&&this.isColumnSticky&&this.$copyOfFirstElement.css("transform","translateY("+t+")")},i.prototype.getTransformMatrixValue=function(t,i){t=t.css("transform");return"none"===t?0:parseInt(t.split(",")[i])},i.prototype.getScrollTopTriggerValue=function(){var t=e(document),i=t.find(".navigation--main.sticky"),s=t.find(".tertiary-menu"),t=i&&0!==i.length;return s&&0!==s.length?s.position().top+s.outerHeight():t?i.position().top+i.outerHeight():0},i.prototype.calculateTranslateY=function(){return Math.floor(Math.min(this.getScrollTopTriggerValue()+e(window).scrollTop()-this.$mainTable.offset().top,this.$mainTable.height()-this.$mainTable.find("thead").first().height()))},i.prototype.handleCopyColumnShadow=function(){0!==this.$tableWrapper.scrollLeft()?this.$copyOfColumn.addClass(this.settings.classes.copyTableFlags.shadow):this.$copyOfColumn.hasClass(this.settings.classes.copyTableFlags.shadow)&&this.$copyOfColumn.removeClass(this.settings.classes.copyTableFlags.shadow)},e.fn.hereTables=i.jQueryInterface=function(t){return this.each(function(){new i(e(this),t)})},s.behaviors.tables={attach:function(t){e(".tables",t).once("tables").hereTables()}}}(jQuery,Drupal);